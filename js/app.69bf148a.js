(function(){"use strict";var e={1249:function(e,t,n){var o=n(5130),r=n(6768);const a={id:"app"};function s(e,t,n,o,s,c){const i=(0,r.g2)("CommanderList");return(0,r.uX)(),(0,r.CE)("div",a,[(0,r.bF)(i)])}var c=n(4232);const i={id:"app"},l={key:0,class:"loading"},d={key:1},u={class:"settings"},m={class:"settings-header"},h={class:"commander-count-wrapper"},f={class:"content"},g={class:"setting"},p={class:"checkbox"},k={class:"checkbox"},b={class:"checkbox"},y={class:"checkbox"},v={class:"checkbox"},C={class:"checkbox"},L={class:"setting"},w={class:"setting"},_={class:"settings-footer"},F={key:0},x={key:1},O={key:0,class:"commanders"},E={class:"commander-img-wrapper"},R=["href"],$=["src"],U={class:"commander-info"},T={class:"commander-info-prices"},V={key:0,class:"commander-info-price"},X={key:1,class:"commander-info-price foil"},D={key:2,class:"commander-info-price etched"},M=["onClick"],j={key:1,class:"generate-image-button-container"},I={ref:"canvas",style:{display:"none"}};function A(e,t,n,a,s,A){return(0,r.uX)(),(0,r.CE)("div",i,[s.loading?((0,r.uX)(),(0,r.CE)("div",l,"Loading...")):((0,r.uX)(),(0,r.CE)("div",d,[(0,r.Lk)("div",u,[(0,r.Lk)("div",m,[t[13]||(t[13]=(0,r.Lk)("div",{class:"title"},"Random Commanders",-1)),(0,r.Lk)("div",h,[t[12]||(t[12]=(0,r.Lk)("label",{for:"commander-count"},"#",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number",id:"commander-count","onUpdate:modelValue":t[0]||(t[0]=e=>s.commanderCount=e),min:"1",max:"10",class:"input"},null,512),[[o.Jo,s.commanderCount,void 0,{number:!0}]])])]),(0,r.bo)((0,r.Lk)("div",f,[(0,r.Lk)("div",g,[t[20]||(t[20]=(0,r.Lk)("div",{class:"title"},"Colors",-1)),(0,r.Lk)("label",p,[(0,r.bo)((0,r.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>s.selectedColors.u=e)},null,512),[[o.lH,s.selectedColors.u]]),t[14]||(t[14]=(0,r.eW)(" Blue "))]),(0,r.Lk)("label",k,[(0,r.bo)((0,r.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>s.selectedColors.b=e)},null,512),[[o.lH,s.selectedColors.b]]),t[15]||(t[15]=(0,r.eW)(" Black "))]),(0,r.Lk)("label",b,[(0,r.bo)((0,r.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>s.selectedColors.w=e)},null,512),[[o.lH,s.selectedColors.w]]),t[16]||(t[16]=(0,r.eW)(" White "))]),(0,r.Lk)("label",y,[(0,r.bo)((0,r.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>s.selectedColors.r=e)},null,512),[[o.lH,s.selectedColors.r]]),t[17]||(t[17]=(0,r.eW)(" Red "))]),(0,r.Lk)("label",v,[(0,r.bo)((0,r.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=e=>s.selectedColors.g=e)},null,512),[[o.lH,s.selectedColors.g]]),t[18]||(t[18]=(0,r.eW)(" Green "))]),(0,r.Lk)("label",C,[(0,r.bo)((0,r.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>s.multicolorOnly=e)},null,512),[[o.lH,s.multicolorOnly]]),t[19]||(t[19]=(0,r.eW)(" Only Multicolor "))])]),(0,r.Lk)("div",L,[t[22]||(t[22]=(0,r.Lk)("div",{class:"title"},"Restriction",-1)),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[7]||(t[7]=e=>s.restriction=e),class:"input"},t[21]||(t[21]=[(0,r.Lk)("option",{value:"none"},"None",-1),(0,r.Lk)("option",{value:"partners"},"Only Partners",-1),(0,r.Lk)("option",{value:"backgrounds"},"Only Backgrounds",-1)]),512),[[o.u1,s.restriction]])]),(0,r.Lk)("div",w,[t[24]||(t[24]=(0,r.Lk)("div",{class:"title"},"Rarity",-1)),(0,r.bo)((0,r.Lk)("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>s.selectedRarity=e),class:"input"},t[23]||(t[23]=[(0,r.Lk)("option",{value:"any"},"Any",-1),(0,r.Lk)("option",{value:"u"},"Uncommon",-1),(0,r.Lk)("option",{value:"m"},"Mythic",-1)]),512),[[o.u1,s.selectedRarity]])])],512),[[o.aG,s.settingsVisible]]),(0,r.Lk)("div",_,[(0,r.Lk)("button",{onClick:t[9]||(t[9]=(...e)=>A.fetchCommanders&&A.fetchCommanders(...e)),class:"btn blue"},"Get Commanders"),(0,r.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>A.toggleSettings&&A.toggleSettings(...e)),class:"btn toggle"},[s.settingsVisible?((0,r.uX)(),(0,r.CE)("span",F,"▲ Hide Settings")):((0,r.uX)(),(0,r.CE)("span",x,"▼ Show Settings"))])])]),s.commanders.length>0?((0,r.uX)(),(0,r.CE)("div",O,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(s.commanders,(e=>((0,r.uX)(),(0,r.CE)("div",{key:e.id,class:"commander-card"},[(0,r.Lk)("div",E,[(0,r.Lk)("a",{href:e.scryfall_uri,target:"_blank",class:"commander-link"},[(0,r.Lk)("img",{src:A.getImageUrl(e),alt:"commander image",class:"commander-img",crossorigin:"anonymous"},null,8,$)],8,R)]),(0,r.Lk)("div",U,[(0,r.Lk)("h2",null,(0,c.v_)(e.name),1),(0,r.Lk)("div",T,[e.prices.usd?((0,r.uX)(),(0,r.CE)("div",V," $"+(0,c.v_)(e.prices.usd),1)):(0,r.Q3)("",!0),e.prices.usd_foil?((0,r.uX)(),(0,r.CE)("div",X," *$"+(0,c.v_)(e.prices.usd_foil),1)):(0,r.Q3)("",!0),e.prices.usd_etched?((0,r.uX)(),(0,r.CE)("div",D," **$"+(0,c.v_)(e.prices.usd_etched),1)):(0,r.Q3)("",!0)]),e.card_faces&&e.card_faces.length>1&&e.card_faces[0].image_uris?((0,r.uX)(),(0,r.CE)("button",{key:0,onClick:t=>A.toggleFace(e),class:"btn green small"}," Transform ",8,M)):(0,r.Q3)("",!0)])])))),128))])):(0,r.Q3)("",!0),s.commanders.length>0?((0,r.uX)(),(0,r.CE)("div",j,[(0,r.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>A.generateImage&&A.generateImage(...e)),class:"btn green"}," Generate Image of Commanders ")])):(0,r.Q3)("",!0)])),(0,r.Lk)("canvas",I,null,512)])}n(4114),n(8992),n(4520),n(1454),n(7550);var P={data(){return{commanders:[],loading:!1,commanderCount:5,selectedColors:{u:!1,b:!1,w:!1,r:!1,g:!1},multicolorOnly:!1,restriction:"none",selectedRarity:"any",lastApiCallTime:0,settingsVisible:!1}},methods:{toggleSettings(){this.settingsVisible=!this.settingsVisible},toggleFace(e){e.isTransformed=!e.isTransformed},getQueryFilter(){const e=Object.entries(this.selectedColors).filter((([e,t])=>t)).map((([e])=>e)).join(""),t=this.multicolorOnly?"%20id>1":"",n=e?`%20(id<=${e}%20-id=c${t})`:t,o="any"!==this.selectedRarity?`%20rarity:${this.selectedRarity}`:"",r="backgrounds"==this.restriction?'%20o:"Choose a background"':"partners"==this.restriction?"%20o:/^partner$/":"",a=[n,o,r].filter((([e])=>e)).join("");return{color:n,rarity:o,full:a}},async fetchCommanders(){this.loading=!0,this.settingsVisible=!1;try{const e=this.getQueryFilter(),t=[];for(let n=0;n<this.commanderCount;n++)t.push(await this.fetchUnique(t,this.fetchRandomCommander,e.full));this.commanders=await this.includeAdditionalCommanders(t,e),this.loading=!1}catch(e){console.error("Error fetching commanders:",e),this.loading=!1}},async includeAdditionalCommanders(e,t){const n=this,o={Partner:{fetchFilter:"o:/^partner$/",count:this.countMatchingCommanders(e,"Partner","Partner with"),shouldFetch(){return 1==this.count}},FriendsForever:{fetchFilter:"o:/^friends forever$/",count:this.countMatchingCommanders(e,"Friends forever"),shouldFetch(){return 1==this.count}},Doctor:{fetchFilter:"o:/^doctor's companion$/",count:this.countMatchingCommanders(e,null,null,"Legendary Creature — Time Lord Doctor"),shouldFetch(){return this.count>0&&0==o.DoctorsCompanion.count}},DoctorsCompanion:{fetchFilter:'t:"Time Lord Doctor"',count:this.countMatchingCommanders(e,"Doctor's companion"),shouldFetch(){return this.count>0&&0==o.Doctor.count}},Backgrounds:{fetchFilter:"t:background",count:this.countMatchingCommanders(e,"Choose a background"),shouldFetch(){return this.amountToFetch()>0},amountToFetch(){return"backgrounds"==n.restriction?n.commanderCount:this.count>0?1:0}}};for(const[r,a]of Object.entries(o))if(a.shouldFetch()){const n="amountToFetch"in a?a.amountToFetch():1,o=`${a.fetchFilter}${t.rarity}`;for(let t=0;t<n;t++)e.push(await this.fetchUnique(e,this.fetchRandom,o))}return e},countMatchingCommanders(e,t=null,n=null,o=null){return e.filter((e=>(!t||e.keywords?.includes(t))&&(!n||!e.keywords?.includes(n))&&(!o||!e.type_line==o))).length},async fetchUnique(e,t,n){const o=4;let r=0;do{const o=await t(n);if(!e.some((e=>e.id===o.id)))return o;r++}while(r<o);throw new Error("Unable to fetch unique commander after multiple attempts.")},async ensureDelay(e){const t=Date.now(),n=t-this.lastApiCallTime,o=Math.max(0,e-n);o>0&&await new Promise((e=>setTimeout(e,o))),this.lastApiCallTime=Date.now()},async fetchRandom(e){await this.ensureDelay(100);const t=await fetch(`https://api.scryfall.com/cards/random?q=${e}%20game:paper%20f:commander`),n=await t.json();return n},async fetchRandomCommander(e){return this.fetchRandom(`is:commander%20-t:background${e}`)},async fetchRandomPartner(e){return this.fetchRandom(`o:/^partner$/${e}`)},async fetchRandomBackground(e){return this.fetchRandom(`t:background${e}`)},getImageUrl(e){return e.image_uris?.normal?e.image_uris.normal:e.card_faces?.length>1?e.card_faces[e.isTransformed?1:0].image_uris.normal:1==e.card_faces?.length?e.card_faces[0].image_uris.normal:"https://via.placeholder.com/400x600"},async generateImage(){const e=this.$refs.canvas,t=e.getContext("2d"),n=3,o=this.commanders.length,r=Math.ceil(o/n),a=400,s=600;e.width=n*a,e.height=r*s;const c=document.querySelectorAll(".commander-img");let i=0;for(const l of c){await new Promise((e=>{l.complete?e():l.onload=e}));const e=i%n*a,o=Math.floor(i/n)*s;t.drawImage(l,e,o,a,s),i++}this.downloadImage(e)},downloadImage(e){const t=document.createElement("a");t.href=e.toDataURL(),t.download="commanders_image.png",t.click()}}},Q=n(1241);const H=(0,Q.A)(P,[["render",A],["__scopeId","data-v-88f3d566"]]);var S=H,W={name:"App",components:{CommanderList:S}};const q=(0,Q.A)(W,[["render",s]]);var B=q;(0,o.Ef)(B).mount("#app")}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,o,r,a){if(!o){var s=1/0;for(d=0;d<e.length;d++){o=e[d][0],r=e[d][1],a=e[d][2];for(var c=!0,i=0;i<o.length;i++)(!1&a||s>=a)&&Object.keys(n.O).every((function(e){return n.O[e](o[i])}))?o.splice(i--,1):(c=!1,a<s&&(s=a));if(c){e.splice(d--,1);var l=r();void 0!==l&&(t=l)}}return t}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[o,r,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,a,s=o[0],c=o[1],i=o[2],l=0;if(s.some((function(t){return 0!==e[t]}))){for(r in c)n.o(c,r)&&(n.m[r]=c[r]);if(i)var d=i(n)}for(t&&t(o);l<s.length;l++)a=s[l],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(d)},o=self["webpackChunkrando_commando"]=self["webpackChunkrando_commando"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(1249)}));o=n.O(o)})();
//# sourceMappingURL=app.69bf148a.js.map